

################################################################################
# WARNING: This file has been auto-generated. DO NOT EDIT: WARNING
# Created on 2020-03-15T16:46:19+1100, using template:DockerfileRuntime.tmpl and json:gearbox.json
# Referenced Docker container for docker-mysql based off gearboxworks/gearbox-base:debian-buster with mysql:5.7.29 overlayed.

ARG VERSION=5.7.29

# 1. First reference the gearbox-base image.
FROM gearboxworks/gearbox-base:debian-buster as gearbox-base

# 2. Next reference the third party image.
FROM mysql:5.7.29
ARG VERSION
ARG GEARBOX_ENTRYPOINT
ARG GEARBOX_ENTRYPOINT_ARGS
USER root

# 3. Copy the build directory over from gearbox-base image.
COPY --from=gearbox-base /etc/gearbox /etc/gearbox

# 4. Set up env variables.
MAINTAINER Gearbox Team <team@gearbox.works>
ENV GEARBOX_CONTAINER_NAME "docker-mysql"
ENV GEARBOX_CONTAINER_VERSION ${VERSION}
ENV GEARBOX_ENTRYPOINT ${GEARBOX_ENTRYPOINT}
ENV GEARBOX_ENTRYPOINT_ARGS ${GEARBOX_ENTRYPOINT_ARGS}
LABEL gearbox.json='{"state": "production","organization": "gearboxworks","name": "mysql","maintainer": "Gearbox Team <team@gearbox.works>","class": "database","network": "--network gearboxnet","ports": ["3306","33060"],"volumes": "","restart": "--restart no","run": "","args": "mysqld","env": {"MYSQL_ALLOW_EMPTY_PASSWORD":"yes","MYSQL_HOST":"127.0.0.1","MYSQL_DATABASE":"gearbox","MYSQL_USER":"gearbox","MYSQL_PASSWORD":"gearbox"},"refurl": "https://www.mysql.com/","versions": {"8.0.19": {"majorversion": "8.0","latest": true,"ref": "mysql:8.0.19","base": "gearboxworks/gearbox-base:debian-buster"},"5.7.29": {"majorversion": "5.7","latest": false,"ref": "mysql:5.7.29","base": "gearboxworks/gearbox-base:debian-buster"},"5.6.47": {"majorversion": "5.6","latest": false,"ref": "mysql:5.6.47","base": "gearboxworks/gearbox-base:debian-stretch"},"5.5.62": {"majorversion": "5.5","latest": false,"ref": "mysql:5.5.62","base": "gearboxworks/gearbox-base:debian-stretch"}}}'
LABEL gearbox.version='5.7.29'
ENV GEARBOX_VERSION "5.7.29"
LABEL container.args="mysqld"
ENV GEARBOX_ARGS "mysqld"
LABEL container.class="database"
ENV GEARBOX_CLASS "database"
# SKIP env
LABEL container.maintainer="Gearbox Team <team@gearbox.works>"
ENV GEARBOX_MAINTAINER "Gearbox Team <team@gearbox.works>"
LABEL container.name="mysql"
ENV GEARBOX_NAME "mysql"
LABEL container.network="--network gearboxnet"
ENV GEARBOX_NETWORK "--network gearboxnet"
LABEL container.organization="gearboxworks"
ENV GEARBOX_ORGANIZATION "gearboxworks"
LABEL container.ports="[3306 33060]"
ENV GEARBOX_PORTS "[3306 33060]"
LABEL container.refurl="https://www.mysql.com/"
ENV GEARBOX_REFURL "https://www.mysql.com/"
LABEL container.restart="--restart no"
ENV GEARBOX_RESTART "--restart no"
LABEL container.run=""
ENV GEARBOX_RUN ""
LABEL container.state="production"
ENV GEARBOX_STATE "production"
# SKIP versions
LABEL container.volumes=""
ENV GEARBOX_VOLUMES ""

LABEL container.base="gearboxworks/gearbox-base:debian-buster"
ENV GEARBOX_BASE "gearboxworks/gearbox-base:debian-buster"
LABEL container.latest="false"
ENV GEARBOX_LATEST "false"
LABEL container.majorversion="5.7"
ENV GEARBOX_MAJORVERSION "5.7"
LABEL container.ref="mysql:5.7.29"
ENV GEARBOX_REF "mysql:5.7.29"

ENV MYSQL_ALLOW_EMPTY_PASSWORD "yes"
ENV MYSQL_DATABASE "gearbox"
ENV MYSQL_HOST "127.0.0.1"
ENV MYSQL_PASSWORD "gearbox"
ENV MYSQL_USER "gearbox"


# 5. Now copy the local files specific to this container.
COPY build /etc/gearbox
COPY ${VERSION}/build /etc/gearbox
COPY ${VERSION}/gearbox.json /etc/gearbox/gearbox.json

# 6. Run the base.sh script to set everything up.
RUN /bin/sh /etc/gearbox/build/base.sh

# 7. Run the mysql.sh script to set everything up.
RUN /bin/sh /etc/gearbox/build/mysql.sh

# 8. Expose ports.
EXPOSE 22 9970 3306 33060 
WORKDIR /home/gearbox/projects

CMD ["/init"]

# END
################################################################################


